
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸­æ–‡è©å½™çŸ¥è­˜åœ–è­œ | Chinese Vocabulary Knowledge Graph</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            font-family: 'Malgun Gothic', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .header {
            text-align: center;
            margin-bottom: 20px;
        }
        .source {
            background: rgba(255,255,255,0.1);
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
        }
        .source a {
            color: #ffeb3b;
            text-decoration: none;
        }
        #graph-container {
            width: 100%;
            height: 80vh;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 10px;
            position: relative;
            background: rgba(255,255,255,0.05);
        }
        .tooltip {
            position: absolute;
            text-align: center;
            padding: 15px;
            font: 14px sans-serif;
            background: rgba(0,0,0,0.9);
            border: 1px solid #fff;
            border-radius: 8px;
            pointer-events: none;
            color: white;
            max-width: 300px;
            z-index: 1000;
        }
        .tooltip .korean {
            font-size: 18px;
            font-weight: bold;
            color: #ffeb3b;
            margin-bottom: 5px;
        }
        .tooltip .chinese {
            font-size: 16px;
            color: #ff5722;
            margin-bottom: 8px;
        }
        .tooltip .definition {
            margin-bottom: 8px;
            font-size: 12px;
        }
        .tooltip .example {
            font-style: italic;
            font-size: 11px;
            color: #ccc;
        }
        .controls {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.7);
            padding: 10px;
            border-radius: 5px;
        }
        .controls button {
            margin: 2px;
            padding: 5px 10px;
            background: #2196F3;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }
        .controls button:hover {
            background: #1976D2;
        }
        .back-button {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0,0,0,0.7);
            padding: 10px;
            border-radius: 5px;
        }
        .back-button a {
            color: #ffeb3b;
            text-decoration: none;
            font-weight: bold;
        }
        .saved-indicator {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #ff6b6b;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            pointer-events: none;
        }
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            z-index: 10000;
            animation: slideIn 0.3s ease;
            border: 2px solid #4ecdc4;
        }
        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        .legend {
            position: absolute;
            bottom: 10px;
            left: 10px;
            background: rgba(0,0,0,0.8);
            padding: 15px;
            border-radius: 5px;
            font-size: 12px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            margin: 5px 0;
        }
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 8px;
            border: 2px solid white;
        }
    </style>
</head>
<body>
    <div class="back-button">
        <a href="/dashboard">â† è¿”å›é¦–é </a>
        <a href="javascript:void(0)" id="reviewLink" onclick="goToReview()" style="margin-left: 10px;">ğŸ“š æˆ‘çš„æ”¶è—</a>
    </div>

    <div class="header">
        <h1>ğŸ‡¨ğŸ‡³ ä¸­æ–‡è©å½™çŸ¥è­˜åœ–è­œ | Chinese Vocabulary Knowledge Graph</h1>
        <p>äº’å‹•å¼è©å½™å­¸ç¿’ç¶²çµ¡ - Interactive Vocabulary Learning Network</p>
    </div>

    <div class="source">
        <strong>è³‡æ–™ä¾†æº Data Source:</strong>
        <a href="https://udn.com/news/story/124626/9122028" target="_blank">https://udn.com/news/story/124626/9122028</a>
        <br>
        <strong>å…± 19 å€‹ä¸­æ–‡è©å½™ | Total 19 Chinese Words</strong>
    </div>

    <div id="graph-container">
        <div class="controls">
            <button onclick="restartSimulation()">é‡æ–°æ’åˆ— Rearrange</button>
            <button onclick="centerGraph()">å±…ä¸­é¡¯ç¤º Center</button>
        </div>
        <div class="legend">
            <div style="font-weight: bold; margin-bottom: 10px;">ğŸ“Š è©å½™åˆ†ç´šåœ–ä¾‹</div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #4CAF50;"></div>
                <span>åŸºç¤ ç¬¬1ç´š</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #2196F3;"></div>
                <span>åŸºç¤ ç¬¬2ç´š</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #9C27B0;"></div>
                <span>åŸºç¤ ç¬¬3ç´š</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #FF9800;"></div>
                <span>é€²éš ç¬¬3ç´š</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #F44336;"></div>
                <span>é€²éš ç¬¬4ç´š</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #D32F2F;"></div>
                <span>é€²éš ç¬¬5ç´š</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #9E9E9E;"></div>
                <span>æœªåˆ†ç´š</span>
            </div>
        </div>
    </div>

    <script>
        // æª¢æ¸¬ç•¶å‰è·¯å¾‘,è‡ªå‹•é©æ‡‰ä»£ç†ç’°å¢ƒ
        function getBasePath() {
            const path = window.location.pathname;
            if (path.startsWith('/chinese-app')) {
                return '/chinese-app';
            }
            return '';
        }

        // å°èˆªå‡½æ•¸
        function goHome() {
            const protocol = window.location.protocol;
            const host = window.location.host;
            const homeUrl = `${protocol}//${host}/dashboard`;
            console.log('Current URL:', window.location.href);
            console.log('Navigating to dashboard:', homeUrl);
            window.location.href = homeUrl;
        }

        function goToReview() {
            const basePath = getBasePath();
            const reviewUrl = basePath + '/review';
            console.log('Navigating to review:', reviewUrl);
            window.location.href = reviewUrl;
        }

        const nodes = [{"id": 0, "chinese": "è¼é”", "english": "Nvidia", "definition": "A global technology company known for its graphics processing units (GPUs) and artificial intelligence (AI) solutions.", "example_chinese": "è¼é”æ˜¯å…¨çƒé ˜å…ˆçš„AIå…¬å¸ã€‚", "example_english": "Nvidia is a leading AI company in the world.", "level": "æœªåˆ†ç´š", "level_category": "æœªåˆ†ç´š", "level_number": "", "group": 6}, {"id": 1, "chinese": "è½è…³", "english": "To settle; to establish oneself", "definition": "To settle down in a place; to establish a business or organization in a particular location.", "example_chinese": "ä»–å€‘æ±ºå®šåœ¨å°åŒ—è½è…³ã€‚", "example_english": "They decided to settle in Taipei.", "level": "ç²¾ç†Ÿ ç¬¬7ç´š", "level_category": "ç²¾ç†Ÿ", "level_number": "ç¬¬7ç´š", "group": 6}, {"id": 2, "chinese": "åŒ—å£«ç§‘", "english": "Beishi Science Park", "definition": "Abbreviation for Beitou Shilin Technology Park, a technology park located in Taipei.", "example_chinese": "åŒ—å£«ç§‘å¸å¼•äº†è¨±å¤šç§‘æŠ€å…¬å¸ã€‚", "example_english": "Beishi Science Park attracts many technology companies.", "level": "æœªåˆ†ç´š", "level_category": "æœªåˆ†ç´š", "level_number": "", "group": 6}, {"id": 3, "chinese": "è”£è¬å®‰", "english": "Chiang Wan-an", "definition": "A Taiwanese politician and the current Mayor of Taipei.", "example_chinese": "è”£è¬å®‰æ˜¯å°åŒ—å¸‚é•·ã€‚", "example_english": "Chiang Wan-an is the mayor of Taipei.", "level": "æœªåˆ†ç´š", "level_category": "æœªåˆ†ç´š", "level_number": "", "group": 6}, {"id": 4, "chinese": "å°åŒ—", "english": "Taipei", "definition": "The capital city of Taiwan.", "example_chinese": "æˆ‘ä½åœ¨å°åŒ—ã€‚", "example_english": "I live in Taipei.", "level": "æœªåˆ†ç´š", "level_category": "æœªåˆ†ç´š", "level_number": "", "group": 6}, {"id": 5, "chinese": "è¨­ç«‹", "english": "To establish; to set up", "definition": "To establish or found an organization, institution, or system.", "example_chinese": "ä»–å€‘è¨ˆåŠƒè¨­ç«‹ä¸€å®¶æ–°å…¬å¸ã€‚", "example_english": "They plan to establish a new company.", "level": "é€²éš ç¬¬5ç´š", "level_category": "é€²éš", "level_number": "ç¬¬5ç´š", "group": 5}, {"id": 6, "chinese": "å…¬å¸", "english": "Company", "definition": "A commercial business.", "example_chinese": "é€™æ˜¯ä¸€å®¶å¾ˆå¤§çš„å…¬å¸ã€‚", "example_english": "This is a big company.", "level": "åŸºç¤ ç¬¬2ç´š", "level_category": "åŸºç¤", "level_number": "ç¬¬2ç´š", "group": 1}, {"id": 7, "chinese": "å¸‚åºœ", "english": "City Government", "definition": "The government of a city.", "example_chinese": "å¸‚åºœæ­£åœ¨æ”¹å–„äº¤é€šã€‚", "example_english": "The city government is improving traffic.", "level": "æœªåˆ†ç´š", "level_category": "æœªåˆ†ç´š", "level_number": "", "group": 6}, {"id": 8, "chinese": "å°æ¥", "english": "To connect; to link up", "definition": "To connect or link up different systems, organizations, or people for communication or cooperation.", "example_chinese": "é›™æ–¹éœ€è¦å°æ¥ç›¸é—œè³‡è¨Šã€‚", "example_english": "Both sides need to connect relevant information.", "level": "æœªåˆ†ç´š", "level_category": "æœªåˆ†ç´š", "level_number": "", "group": 6}, {"id": 9, "chinese": "ç°½ç´„", "english": "To sign a contract", "definition": "To sign a contract, agreement, or deal.", "example_chinese": "ä»–å€‘ç°½ç´„åˆä½œã€‚", "example_english": "They signed a contract to cooperate.", "level": "é€²éš ç¬¬5ç´š", "level_category": "é€²éš", "level_number": "ç¬¬5ç´š", "group": 5}, {"id": 10, "chinese": "ç¸½éƒ¨", "english": "Headquarters", "definition": "The main office or center of operations for an organization or company.", "example_chinese": "å…¬å¸ç¸½éƒ¨åœ¨ç´ç´„ã€‚", "example_english": "The company headquarters is in New York.", "level": "æœªåˆ†ç´š", "level_category": "æœªåˆ†ç´š", "level_number": "", "group": 6}, {"id": 11, "chinese": "ç”¢ç¶“", "english": "Industry and Economy", "definition": "Relating to industry and economics.", "example_chinese": "é€™å€‹æ–°èå ±å°äº†ç”¢ç¶“æ¶ˆæ¯ã€‚", "example_english": "This news reports industry and economic news.", "level": "æœªåˆ†ç´š", "level_category": "æœªåˆ†ç´š", "level_number": "", "group": 6}, {"id": 12, "chinese": "è¯åˆ", "english": "United; Joint", "definition": "Formed or produced by the combination of two or more things.", "example_chinese": "ä»–å€‘è¯åˆèµ·ä¾†å°æŠ—æ•µäººã€‚", "example_english": "They united to fight the enemy.", "level": "é€²éš ç¬¬5ç´š", "level_category": "é€²éš", "level_number": "ç¬¬5ç´š", "group": 5}, {"id": 13, "chinese": "æ–°èç¶²", "english": "News Website", "definition": "A website that provides news reports and current events.", "example_chinese": "æˆ‘æ¯å¤©éƒ½çœ‹æ–°èç¶²ã€‚", "example_english": "I read the news website every day.", "level": "æœªåˆ†ç´š", "level_category": "æœªåˆ†ç´š", "level_number": "", "group": 6}, {"id": 14, "chinese": "æ–°å…‰äººå£½", "english": "Shin Kong Life Insurance", "definition": "A Taiwanese life insurance company.", "example_chinese": "æ–°å…‰äººå£½æ˜¯å°ç£çŸ¥åçš„ä¿éšªå…¬å¸ã€‚", "example_english": "Shin Kong Life Insurance is a well-known insurance company in Taiwan.", "level": "æœªåˆ†ç´š", "level_category": "æœªåˆ†ç´š", "level_number": "", "group": 6}, {"id": 15, "chinese": "ä¼æ¥­", "english": "Enterprise", "definition": "A business organization.", "example_chinese": "é€™æ˜¯ä¸€å€‹æˆåŠŸçš„ä¼æ¥­ã€‚", "example_english": "This is a successful enterprise.", "level": "é€²éš ç¬¬4*ç´š", "level_category": "é€²éš", "level_number": "ç¬¬4*ç´š", "group": 4}, {"id": 16, "chinese": "è³‡æœ¬", "english": "Capital", "definition": "Wealth in the form of money or other assets owned by a person or organization.", "example_chinese": "å…¬å¸éœ€è¦æ›´å¤šè³‡æœ¬ã€‚", "example_english": "The company needs more capital.", "level": "é€²éš ç¬¬4*ç´š", "level_category": "é€²éš", "level_number": "ç¬¬4*ç´š", "group": 4}, {"id": 17, "chinese": "è§£ç´„", "english": "Terminate a contract", "definition": "To cancel or terminate a contract or agreement.", "example_chinese": "ä»–å€‘æ±ºå®šè§£ç´„ã€‚", "example_english": "They decided to terminate the contract.", "level": "ç²¾ç†Ÿ ç¬¬6ç´š", "level_category": "ç²¾ç†Ÿ", "level_number": "ç¬¬6ç´š", "group": 6}, {"id": 18, "chinese": "é€²é§", "english": "To station (troops); to be stationed (of troops)", "definition": "To move in to occupy or to establish oneself in a place or position.", "example_chinese": "è»éšŠé€²é§è©²åœ°å€ã€‚", "example_english": "Troops were stationed in the area.", "level": "ç²¾ç†Ÿ ç¬¬6ç´š", "level_category": "ç²¾ç†Ÿ", "level_number": "ç¬¬6ç´š", "group": 6}];
        const links = [{"source": 0, "target": 12, "value": 1}, {"source": 0, "target": 11, "value": 3}, {"source": 0, "target": 1, "value": 2}, {"source": 1, "target": 3, "value": 1}, {"source": 1, "target": 16, "value": 1}, {"source": 1, "target": 18, "value": 3}, {"source": 2, "target": 3, "value": 3}, {"source": 2, "target": 5, "value": 1}, {"source": 2, "target": 15, "value": 2}, {"source": 3, "target": 11, "value": 1}, {"source": 3, "target": 1, "value": 2}, {"source": 3, "target": 18, "value": 2}, {"source": 4, "target": 11, "value": 3}, {"source": 4, "target": 2, "value": 3}, {"source": 4, "target": 0, "value": 1}, {"source": 5, "target": 3, "value": 3}, {"source": 5, "target": 18, "value": 2}, {"source": 5, "target": 14, "value": 2}, {"source": 6, "target": 1, "value": 1}, {"source": 6, "target": 15, "value": 1}, {"source": 6, "target": 2, "value": 2}, {"source": 7, "target": 16, "value": 2}, {"source": 7, "target": 17, "value": 1}, {"source": 7, "target": 3, "value": 3}, {"source": 8, "target": 13, "value": 1}, {"source": 8, "target": 15, "value": 1}, {"source": 8, "target": 3, "value": 2}, {"source": 9, "target": 3, "value": 1}, {"source": 9, "target": 17, "value": 3}, {"source": 10, "target": 15, "value": 1}, {"source": 10, "target": 0, "value": 1}, {"source": 10, "target": 11, "value": 2}, {"source": 11, "target": 18, "value": 2}, {"source": 11, "target": 12, "value": 2}, {"source": 11, "target": 1, "value": 3}, {"source": 12, "target": 3, "value": 1}, {"source": 12, "target": 11, "value": 1}, {"source": 12, "target": 6, "value": 1}, {"source": 13, "target": 14, "value": 2}, {"source": 13, "target": 9, "value": 3}, {"source": 13, "target": 16, "value": 2}, {"source": 14, "target": 1, "value": 3}, {"source": 14, "target": 4, "value": 1}, {"source": 15, "target": 5, "value": 2}, {"source": 15, "target": 11, "value": 3}, {"source": 15, "target": 1, "value": 3}, {"source": 16, "target": 3, "value": 3}, {"source": 16, "target": 17, "value": 1}, {"source": 16, "target": 4, "value": 2}, {"source": 17, "target": 5, "value": 2}, {"source": 17, "target": 16, "value": 2}, {"source": 17, "target": 9, "value": 3}, {"source": 18, "target": 8, "value": 2}, {"source": 18, "target": 9, "value": 2}, {"source": 18, "target": 12, "value": 3}];

        const width = document.getElementById('graph-container').clientWidth;
        const height = document.getElementById('graph-container').clientHeight;

        const svg = d3.select("#graph-container")
            .append("svg")
            .attr("width", width)
            .attr("height", height);

        const g = svg.append("g");

        // æ·»åŠ ç¸®æ”¾åŠŸèƒ½
        const zoom = d3.zoom()
            .scaleExtent([0.1, 4])
            .on('zoom', function(event) {
                g.attr('transform', event.transform);
            });

        svg.call(zoom);

        // é¡è‰²æ¯”ä¾‹å°ºï¼ˆä¾æ“šè©å½™åˆ†ç´šï¼‰
        // 0=åŸºç¤ç¬¬1ç´š(ç¶ ), 1=åŸºç¤ç¬¬2ç´š(è—), 2=åŸºç¤ç¬¬3ç´š(ç´«), 3=é€²éšç¬¬3ç´š(æ©™), 4=é€²éšç¬¬4ç´š(ç´…), 5=é€²éšç¬¬5ç´š(æ·±ç´…), 6=æœªåˆ†ç´š(ç°)
        const color = d3.scaleOrdinal()
            .domain([0, 1, 2, 3, 4, 5, 6])
            .range(['#4CAF50', '#2196F3', '#9C27B0', '#FF9800', '#F44336', '#D32F2F', '#9E9E9E']);

        // åŠ›æ¨¡æ“¬
        const simulation = d3.forceSimulation(nodes)
            .force("link", d3.forceLink(links).id(d => d.id).distance(100))
            .force("charge", d3.forceManyBody().strength(-400))
            .force("center", d3.forceCenter(width / 2, height / 2))
            .force("collision", d3.forceCollide().radius(40));

        // å‰µå»ºé€£æ¥ç·š
        const link = g.append("g")
            .selectAll("line")
            .data(links)
            .enter().append("line")
            .attr("stroke", "rgba(255,255,255,0.3)")
            .attr("stroke-width", d => Math.sqrt(d.value) * 2);

        // å‰µå»ºç¯€é»
        const node = g.append("g")
            .selectAll("g")
            .data(nodes)
            .enter().append("g")
            .call(d3.drag()
                .on("start", dragstarted)
                .on("drag", dragged)
                .on("end", dragended));

        // ç¯€é»åœ“åœˆ
        node.append("circle")
            .attr("r", 25)
            .attr("fill", d => color(d.group))
            .attr("stroke", "#fff")
            .attr("stroke-width", 3);

        // ç¯€é»æ–‡å­—ï¼ˆä¸­æ–‡ï¼‰
        node.append("text")
            .text(d => d.chinese)
            .attr("x", 0)
            .attr("y", 0)
            .attr("text-anchor", "middle")
            .attr("dominant-baseline", "middle")
            .attr("font-size", "12px")
            .attr("font-weight", "bold")
            .attr("fill", "white")
            .attr("pointer-events", "none");

        // è‹±æ–‡ç¿»è­¯æ¨™ç±¤
        node.append("text")
            .text(d => d.english)
            .attr("x", 0)
            .attr("y", 35)
            .attr("text-anchor", "middle")
            .attr("font-size", "10px")
            .attr("fill", "#ffeb3b")
            .attr("pointer-events", "none");

        // å·¥å…·æç¤º
        const tooltip = d3.select("body").append("div")
            .attr("class", "tooltip")
            .style("opacity", 0);

        // é¡¯ç¤ºé€šçŸ¥
        function showNotification(message, isSuccess = true) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.style.borderColor = isSuccess ? '#4ecdc4' : '#ff6b6b';
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // æ”¶è—å–®å­—åŠŸèƒ½
        function saveWord(wordData) {
            const basePath = getBasePath();
            fetch(`${basePath}/api/saved-words`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ word: wordData })
            })
            .then(response => response.json())
            .then(data => {
                if (data.exists) {
                    showNotification('âš ï¸ å–®å­—å·²åœ¨æ”¶è—ä¸­', false);
                } else {
                    showNotification('âœ… å–®å­—å·²æ”¶è—ï¼');
                    // æ¨™è¨˜æ­¤ç¯€é»ç‚ºå·²æ”¶è—
                    markNodeAsSaved(wordData.chinese);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                showNotification('âŒ æ”¶è—å¤±æ•—', false);
            });
        }

        // æ¨™è¨˜ç¯€é»ç‚ºå·²æ”¶è—
        function markNodeAsSaved(chinese) {
            node.each(function(d) {
                if (d.chinese === chinese) {
                    const nodeGroup = d3.select(this);
                    // æª¢æŸ¥æ˜¯å¦å·²æœ‰æ¨™è¨˜
                    if (nodeGroup.select('.saved-indicator').empty()) {
                        nodeGroup.append('text')
                            .attr('class', 'saved-indicator')
                            .text('â­')
                            .attr('x', 20)
                            .attr('y', -20)
                            .attr('font-size', '16px')
                            .attr('pointer-events', 'none');
                    }
                }
            });
        }

        // è¼‰å…¥å·²æ”¶è—çš„å–®å­—ä¸¦æ¨™è¨˜
        (function() {
            const basePath = getBasePath();
            fetch(`${basePath}/api/saved-words`)
                .then(response => response.json())
                .then(data => {
                    const savedChinese = data.words.map(w => w.chinese);
                    savedChinese.forEach(chinese => {
                        markNodeAsSaved(chinese);
                    });
                })
                .catch(error => console.error('Error loading saved words:', error));
        })();

        // ç¯€é»äº‹ä»¶
        node.on("mouseover", function(event, d) {
            tooltip.transition()
                .duration(200)
                .style("opacity", .9);

            // æ ¹æ“šåˆ†ç´šé¡¯ç¤ºä¸åŒé¡è‰²çš„æ¨™ç±¤
            let levelColor = '#9E9E9E';  // é è¨­ç°è‰²
            if (d.level_category === 'åŸºç¤') {
                levelColor = '#4CAF50';  // ç¶ è‰²ç³»
            } else if (d.level_category === 'é€²éš') {
                levelColor = '#F44336';  // ç´…è‰²ç³»
            }

            tooltip.html(`
                <div class="korean">${d.chinese}</div>
                <div class="chinese">${d.english}</div>
                <div style="background-color: ${levelColor}; padding: 3px 8px; border-radius: 3px; margin: 5px 0; display: inline-block;">
                    <strong>åˆ†ç´š Level:</strong> ${d.level}
                </div>
                <div class="definition"><strong>Definition:</strong> ${d.definition}</div>
                <div class="example"><strong>ä¸­æ–‡ä¾‹å¥:</strong> ${d.example_chinese}</div>
                <div class="example"><strong>English:</strong> ${d.example_english}</div>
                <div style="margin-top: 10px; font-size: 10px; color: #4ecdc4;">ğŸ’¡ é›™æ“Šç¯€é»æ”¶è—å–®å­— Double-click to save</div>
            `)
                .style("left", (event.pageX + 10) + "px")
                .style("top", (event.pageY - 28) + "px");
        })
        .on("mouseout", function(d) {
            tooltip.transition()
                .duration(500)
                .style("opacity", 0);
        })
        .on("dblclick", function(event, d) {
            event.stopPropagation();
            saveWord({
                chinese: d.chinese,
                english: d.english,
                definition: d.definition,
                example_chinese: d.example_chinese,
                example_english: d.example_english,
                level: d.level,
                level_category: d.level_category,
                level_number: d.level_number
            });
        });

        // æ¨¡æ“¬æ›´æ–°
        simulation.on("tick", () => {
            link
                .attr("x1", d => d.source.x)
                .attr("y1", d => d.source.y)
                .attr("x2", d => d.target.x)
                .attr("y2", d => d.target.y);

            node
                .attr("transform", d => `translate(${d.x},${d.y})`);
        });

        // æ‹–æ‹½åŠŸèƒ½
        function dragstarted(event, d) {
            if (!event.active) simulation.alphaTarget(0.3).restart();
            d.fx = d.x;
            d.fy = d.y;
        }

        function dragged(event, d) {
            d.fx = event.x;
            d.fy = event.y;
        }

        function dragended(event, d) {
            if (!event.active) simulation.alphaTarget(0);
            d.fx = null;
            d.fy = null;
        }

        // æ§åˆ¶åŠŸèƒ½
        function restartSimulation() {
            simulation.alpha(1).restart();
        }

        function centerGraph() {
            const transform = d3.zoomIdentity.translate(width / 2, height / 2).scale(1);
            svg.transition().duration(750).call(zoom.transform, transform);
        }
    </script>
</body>
</html>
    